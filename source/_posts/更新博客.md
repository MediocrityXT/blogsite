---
title: 更新博客
date: '2024-12-01 19:42:25'
math: false
excerpt: ''
tags:
- fleeting
---

把obsidian文章导入博客文件夹，一键更新和发布。
实现解析tag和Excerpt，自动生成Front-Matter。
~~版本控制，实现自己和博客发布双版本。~~
博客仓库config和source+assests解耦。
> frontmatter里的tags和正文 `#xxx` 的tags都一样可以被obsidian识别

博客缓存记录格式：{key: {原始hash, YAML, 正文内容是否手动修改}}

1. 运行add-front-matter.py，在obsidian中尝试读取所有文件的FrontMatter的tags，并且解析第一行可能存在的tags，对所有包含“博客”tag的markdown文件，自动去除第一行tags，生成FrontMatter。最后获得obsidian博客列表+hash列表。
2. 运行copy-to-hexo.py读取YAML配置文件。obsidian列表中不在hexo中的，或者hash不同的，重新处理该obsidian markdown文档
	1. 预处理策略，去掉敏感信息段落 `> ![Danger]` 块，大小写不敏感
	2. 检查引用本地图片，非md非pdf是否存在，存在则转移到hexo img dir
	3. 引用md和pdf则去掉链接格式，只保留《文件名》
		1. 双链文章如果在博客缓存中出现，则改为网页url
3. 添加Yaml信息到缓存，保存excerpt。
4. 将预处理的结果存到博客缓存区，如果**你之前手动修改过的终稿**这次源文件有更新，则提示，需要手动处理两次不同的结果，避免你的手动修改遗失；处理出错的报错。
5. 确认博客仓库更新完毕后，发布：md+assets送到博客仓库git push, deploy
	1. 或者支持同步发布到知乎CSDN等平台
> [!Warning] 
> 双链： [Obsidian使用](Obsidian使用.md)
> 定位到标题: [笔记标签基本分类](Obsidian使用.md#笔记标签基本分类)
> [LLM部署(vllm+hf download)](毕设/LLM部署(vllm+hf%20download).md)



# 旧博客文章转移
1. 图片转移到attachments，修改图片链接
2. 检查是否存在YAML(第一行为---)，如果存在，读取excerpt和math，否则置空
3. 创建YAML，title置为文件名，date置为文件创建时间，读取第一行tags并删除，放入YAML tags中，添加excerpt
4. 添加YAML到md中并保存

python-frontmatter库
HEXO部署
[GitHub - lifeodyssey/obsidian-hexo-auto-update](https://github.com/lifeodyssey/obsidian-hexo-auto-update)
[在 GitHub Pages 上部署 Hexo | Hexo](https://hexo.io/zh-cn/docs/github-pages)
可能的参考：
[GitHub - piz-ewing/obsidian-push-2-hexo: It is used to convert note to hexo supported format and package to directory.](https://github.com/piz-ewing/obsidian-push-2-hexo)

[obsidian-hexo-publisher/src/hexo.ts at master · zhenlohuang/obsidian-hexo-publisher · GitHub](https://github.com/zhenlohuang/obsidian-hexo-publisher/blob/master/src/hexo.ts)